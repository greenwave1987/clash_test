name: Playwright Proxy Test
on:
  push:
    branches: [ main ]
  workflow_dispatch: # 支持手动触发

jobs:
  run-playwright:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          # requests[socks] 用于支持 socks5 代理测试
          pip install requests[socks] playwright
          # 安装 Playwright 浏览器及其系统依赖
          playwright install chromium --with-deps

      - name: Run script
        env:
          # 在 GitHub Repo Settings -> Secrets -> Actions 中添加此变量
          SOCKS5_INFO: ${{ secrets.SOCKS5_INFO }}
        run: python main.py
